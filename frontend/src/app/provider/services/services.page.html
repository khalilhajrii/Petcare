<ion-content class="ion-padding">
  <div class="services-container">
    <div class="header-container">
      <h1>Mes Services</h1>
      <p>Gérez les services que vous proposez à vos clients</p>
    </div>

    <div class="actions-container">
      <ion-button (click)="toggleServiceForm()" class="add-service-btn">
        <ion-icon [name]="showServiceForm ? 'close-outline' : 'add-outline'" slot="start"></ion-icon>
        {{ showServiceForm ? 'Annuler' : 'Ajouter un service' }}
      </ion-button>
    </div>

    <div *ngIf="showServiceForm" class="service-form-container">
      <ion-card>
        <ion-card-header>
          <ion-card-title>{{ isEditMode ? 'Modifier le service' : 'Ajouter un nouveau service' }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <form [formGroup]="serviceForm" (ngSubmit)="saveService()">
            <div class="form-group">
              <ion-item>
                <ion-label position="floating">Nom du service</ion-label>
                <ion-input formControlName="nomservice" type="text"></ion-input>
              </ion-item>
              <ion-note color="danger" *ngIf="serviceForm.get('nomservice')?.invalid && serviceForm.get('nomservice')?.touched">
                Le nom du service est requis (minimum 3 caractères)
              </ion-note>
            </div>

            <div class="form-group">
              <ion-item>
                <ion-label position="floating">Prix (€)</ion-label>
                <ion-input formControlName="prixService" type="number" min="0"></ion-input>
              </ion-item>
              <ion-note color="danger" *ngIf="serviceForm.get('prixService')?.invalid && serviceForm.get('prixService')?.touched">
                Le prix est requis et doit être positif
              </ion-note>
            </div>

            <div class="form-group">
              <ion-item>
                <ion-label position="floating">Description</ion-label>
                <ion-textarea formControlName="description" rows="3"></ion-textarea>
              </ion-item>
              <ion-note color="danger" *ngIf="serviceForm.get('description')?.invalid && serviceForm.get('description')?.touched">
                La description est requise (minimum 10 caractères)
              </ion-note>
            </div>

            <div class="form-group">
              <ion-item>
                <ion-label position="floating">Détails du service</ion-label>
                <ion-textarea formControlName="servicedetail" rows="4"></ion-textarea>
              </ion-item>
              <ion-note color="danger" *ngIf="serviceForm.get('servicedetail')?.invalid && serviceForm.get('servicedetail')?.touched">
                Les détails du service sont requis
              </ion-note>
            </div>

            <div class="form-actions">
              <ion-button expand="block" type="submit" [disabled]="serviceForm.invalid">
                <ion-icon name="save-outline" slot="start"></ion-icon>
                {{ isEditMode ? 'Mettre à jour' : 'Créer le service' }}
              </ion-button>
            </div>
          </form>
        </ion-card-content>
      </ion-card>
    </div>

    <div *ngIf="isLoading" class="loading-container">
      <ion-spinner name="circles"></ion-spinner>
      <p>Chargement des services...</p>
    </div>

    <div *ngIf="!isLoading && services.length === 0" class="empty-state">
      <ion-icon name="briefcase-outline"></ion-icon>
      <h2>Aucun service disponible</h2>
      <p>Vous n'avez pas encore créé de services. Cliquez sur "Ajouter un service" pour commencer.</p>
    </div>

    <div *ngIf="!isLoading && services.length > 0" class="services-grid">
      <ion-card *ngFor="let service of services" class="service-card">
        <ion-card-header>
          <ion-card-title>{{ service.nomservice }}</ion-card-title>
          <ion-card-subtitle>{{ service.prixService | currency:'EUR':'symbol':'1.2-2' }}</ion-card-subtitle>
        </ion-card-header>
        <ion-card-content>
          <div class="service-description">
            <p>{{ service.description }}</p>
          </div>
          <div class="service-details">
            <h3>Détails</h3>
            <p>{{ service.servicedetail }}</p>
          </div>
          <div class="service-actions">
            <ion-button fill="outline" color="primary" (click)="editService(service)">
              <ion-icon name="create-outline" slot="start"></ion-icon>
              Modifier
            </ion-button>
            <ion-button fill="outline" color="danger" (click)="confirmDelete(service)">
              <ion-icon name="trash-outline" slot="start"></ion-icon>
              Supprimer
            </ion-button>
          </div>
        </ion-card-content>
      </ion-card>
    </div>
  </div>
</ion-content>